# Partitioning Machines: A Framework to characterize the VC and Natarajan dimension of decision trees

## Preface
This package provides an implementation of the algorithms presented in the paper "Decision trees as partitioning machines to characterize their VC dimension".

## Content

This package provides implementations of the algorithms that computes an upper and lower bound on the VC dimension of binary decision trees, as well as other useful tools to work with scikit-learn decision trees.
The experiments folder contains all the files necessary to reproduce all experiments.

### Detailled content
#### _partitioning_machines_ module
- Tree object built in a recursive manner in the file 'tree.py'.
- Partitioning function upper bound object that implements an optimized version of the algorithm 1 of Appendix E in the file 'partitioning_function_upper_bound.py'.
- VC dimension lower and upper bounds algorithms provided in the file 'vcdim.py'.
- Implementation from scratch of the CART algorithm to greedily grow a binary decision tree with the Gini index or other impurity score in the file 'decision_tree_classifier.py'
- Generalization bounds such as Shawe-Taylor's bound and Vapnik's bound in the file 'generalization_bounds.py'.
- Label encoder object to handle the labels of the datasets and convert them to a one-hot encoding in the file 'label_encoder.py'.
##### _utils_ module
- Tree conversion from scikit-learn decision trees to present implementation in the file 'convert_tree.py'.
- Tools to draw automatically binary trees in LaTeX in the file 'draw_tree.py'.
#### _examples_ folder
- Comparison of the tree generated by the scikit-learn implementation and our implementation of DecisionTreeClassifier in the file 'comparison_with_sklearn.py'.
- Example on how to draw a binary tree in LaTeX in the file 'draw_tree_in_tex.py'.
- Step by step pruning is depicted in the file 'sequential_tree_pruning.py'.
- The bounds on the VC dimension of various tree structures is computed in the file 'vcdim_computation.py'.
#### _experiments_ folder
- A 'main.py' file launches the experiments.
- A 'pruning.py' files implements the two types of pruning (cross-validation or bound-based).
##### _datasets_ folder
- A dataset manager is provided in the file 'datasets.py', which downloads and loads in memory automatically datasets from the UCI Machine Learning Repository. Datasets are stored in a folder named 'raw' once downloaded.
##### _scripts_ folder
- A script to cross-validate the optimal value of 'r' in the distribution 'q_k' in the file 'cross_validate_errors_prior.py'.
- A script to generate the Table 1 automatically from the results once the experiments are run in the file 'process_all_results.py'
- A script to generate Table 2 to 20 automatically from the results once the experiments are run in the file 'process_results_by_dataset.py'.
- A script to visualize the differences between the studied models in the file 'tree_pruning_comparison.py'.
